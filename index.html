<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Media Pembelajaran Interaktif - Etnomatematika Candi Penataran</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');

* { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }

/* --- AUDIO PLAYER --- */
.audio-controls {
    position: fixed; bottom: 15px; right: 15px; z-index: 100;
    background: linear-gradient(135deg, rgba(139,90,43,0.95), rgba(193,154,107,0.9));
    border-radius: 25px; padding: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.4);
    backdrop-filter: blur(15px); width: 85px; text-align: center; border: 2px solid rgba(255,255,255,0.2);
}
#audioToggle {
    background: rgba(255,255,255,0.15); border: none; color: white; font-size: 26px;
    cursor: pointer; padding: 12px; border-radius: 50%; width: 56px; height: 56px;
    display: flex; align-items: center; justify-content: center; margin: 0 auto 8px;
}
#audioStatus { color: white; font-size: 11px; font-weight: 600; }

/* --- LAYOUT & THEME --- */
body {
    min-height: 100vh; transition: all 1s ease;
    background: linear-gradient(rgba(60,40,20,0.5), rgba(60,40,20,0.7)), url('candi.jpg');
    background-size: cover; background-position: center; background-attachment: fixed;
}
body.malam { background: linear-gradient(rgba(10,20,70,0.85), rgba(5,10,40,0.95)), url('candi.jpg'); background-size: cover; background-position: center; background-attachment: fixed;}

.logo { position: absolute; top: 20px; left: 20px; z-index: 50; width: 300px; }
.logo img { width: 100%; object-fit: contain; }

.toggle {
    position: fixed; top: 20px; right: 20px; z-index: 50;
    padding: 12px 24px; border: none; border-radius: 30px;
    background: #8b5a2b; color: white; cursor: pointer; font-weight: 600;
}

header {
    position: relative; z-index: 30; background: rgba(255,235,205,0.97);
    text-align: center; padding: 100px 20px 50px; border-bottom: 5px solid #8b5a2b;
}
header h1 { color: #6b3f1d; font-size: 32px; font-weight: 700; }

.container {
    position: relative; z-index: 30; max-width: 1000px;
    margin: 50px auto; padding: 25px;
    display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px;
}

/* --- CARDS --- */
.card {
    background: rgba(255,245,230,0.97); border-radius: 22px;
    padding: 40px 30px; text-align: center; box-shadow: 0 15px 35px rgba(0,0,0,0.25);
    display: flex; flex-direction: column; justify-content: space-between; transition: 0.3s;
}
.card a, .card button {
    display: inline-block; padding: 15px; background: linear-gradient(135deg, #8b5a2b, #c19a6b);
    color: white; text-decoration: none; border-radius: 35px; border: none;
    cursor: pointer; font-weight: 600; width: 100%; margin-top: 15px;
}

/* --- RANKING STYLE --- */
.ranking-card { 
    grid-column: 1 / -1; background: #fdf5e6; border-radius: 30px; padding: 40px; box-shadow: 0 10px 40px rgba(0,0,0,0.1);
}
.ranking-title { text-align: center; font-size: 28px; color: #5d4037; font-weight: 700; margin-bottom: 30px; }
.ranking-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
.ranking-item { 
    display: flex; align-items: center; justify-content: space-between;
    background: white; padding: 15px 25px; border-radius: 15px;
}
.rank-grade-circle { width: 40px; height: 40px; border-radius: 50%; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; }
.g-A { background: #4caf50; } .g-B { background: #2196f3; } .g-C { background: #ff9800; } .g-D { background: #f44336; }

/* --- MODAL SYSTEM --- */
.modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 1000; justify-content: center; align-items: center; padding: 20px; }
.modal.active { display: flex; }
.modal-content { background: white; max-width: 850px; width: 95%; border-radius: 25px; padding: 35px; max-height: 90vh; overflow-y: auto; position: relative; }
.close-btn { position: absolute; right: 20px; top: 10px; font-size: 35px; cursor: pointer; color: #666; }

/* --- CP & TP STYLES --- */
.cp-box { background: #fff8f0; padding: 20px; border-radius: 15px; border-left: 6px solid #8b5a2b; margin-bottom: 20px; }
.tp-item { display: flex; align-items: start; gap: 15px; margin-bottom: 15px; background: #f0f7ff; padding: 15px; border-radius: 12px; text-align: left; }
.tp-num { background: #2196f3; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-weight: bold; }

/* --- QUIZ STYLES --- */
.hidden { display: none; }
.quiz-image { max-width: 100%; max-height: 250px; border-radius: 15px; margin-bottom: 15px; display: block; margin-left: auto; margin-right: auto; border: 3px solid #8b5a2b; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
.option { background: #f8f9fa; padding: 15px; border-radius: 12px; margin-bottom: 10px; cursor: pointer; border: 2px solid transparent; }
.option.selected { background: #e3f2fd; border-color: #2196f3; }
.option.correct { background: #c8e6c9; border-color: #4caf50; }
.option.wrong { background: #ffcdd2; border-color: #f44336; }
.progress-bar { height: 10px; background: #eee; border-radius: 5px; margin: 15px 0; overflow: hidden; }
.progress { height: 100%; background: #8b5a2b; width: 0%; transition: 0.5s; }

footer { text-align: center; padding: 20px; color: white; font-weight: 500; }

@media (max-width: 768px) { .container, .ranking-grid { grid-template-columns: 1fr; } }
</style>
</head>
<body>

<div class="audio-controls">
    <button id="audioToggle">üéµ</button>
    <div id="audioStatus">Mati</div>
    <audio id="gamelanAudio" loop preload="auto"><source src="gamelan.mp3" type="audio/mpeg"></audio>
</div>

<div class="logo"><img src="logo.png" alt="Logo"></div>
<button class="toggle" onclick="toggleMode()">üåô / üåû</button>

<header>
    <h1>üìö Media Pembelajaran Interaktif</h1>
    <p>Etnomatematika Candi Penataran</p>
</header>

<section class="container">
    <div class="card">
        <div><h2>üìñ Materi</h2><p>E-Book interaktif etnomematika.</p></div>
        <a href="https://heyzine.com/flip-book/29880c854c.html" target="_blank">Buka Materi</a>
    </div>

    <div class="card">
        <div><h2>‚úçÔ∏è Latihan Soal</h2><p>Latihan interaktif Wordwall.</p></div>
        <a href="https://wordwall.net/id/resource/103407679" target="_blank">Mulai Latihan</a>
    </div>

    <div class="card">
        <div><h2>üéØ CP & TP</h2><p>Capaian & Tujuan Pembelajaran.</p></div>
        <button onclick="openCPTP()">Lihat Detail</button>
    </div>

    <div class="card">
        <div><h2>üìù Soal Ujian</h2><p>Kuis 10 soal interaktif.</p></div>
        <button onclick="openQuiz()">Masuk Ujian</button>
    </div>

    <div class="ranking-card">
        <h2 class="ranking-title">üèÜ Papan Peringkat Teratas</h2>
        <div id="home-ranking-list" class="ranking-grid"></div>
    </div>
</section>

<div class="modal" id="cptpModal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeCPTP()">&times;</span>
        <h2 style="color: #6b3f1d; text-align: center; margin-bottom: 25px;">üéØ Capaian & Tujuan Pembelajaran</h2>
        <div class="cp-box">
            <h3 style="color: #8b5a2b; margin-bottom: 10px;">Capaian Pembelajaran (CP) - Fase B</h3>
            <p style="line-height: 1.6;">Peserta didik dapat mendeskripsikan ciri berbagai bentuk bangun datar (segiempat, segitiga, segibanyak), menyusun (komposisi) dan mengurai (dekomposisi) berbagai bangun datar, serta mengukur luas dan volume menggunakan satuan tak baku dan baku.</p>
        </div>
        <h3 style="color: #2196f3; margin-bottom: 15px; text-align: left;">Tujuan Pembelajaran (TP):</h3>
        <div class="tp-item"><div class="tp-num">1</div><p>Mengidentifikasi unsur-unsur bangun datar (sisi, sudut) dan jenis-jenisnya (persegi, segitiga, persegi panjang, jajar genjang, belah ketupat, dll.).</p></div>
        <div class="tp-item"><div class="tp-num">2</div><p>Mendeskripsikan ciri-ciri khusus dari bangun datar tersebut (misalnya, persegi memiliki 4 sisi sama panjang dan 4 sudut siku-siku).</p></div>
        <div class="tp-item"><div class="tp-num">3</div><p>Menyusun (menggabungkan) dan mengurai (memecah) bangun datar menjadi bentuk lain.</p></div>
        <div class="tp-item"><div class="tp-num">4</div><p>Mengukur luas dan volume bangun datar menggunakan satuan tak baku (misalnya, kertas petak) dan baku (cm¬≤, m¬≤).</p></div>
        <div class="tp-item"><div class="tp-num">5</div><p>Menentukan hubungan antar-satuan baku panjang (cm ke m) yang relevan untuk luas.</p></div>
        <button onclick="closeCPTP()" style="padding: 15px; width: 100%; background: #8b5a2b; color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold;">Saya Mengerti ‚úÖ</button>
    </div>
</div>

<div class="modal" id="quizModal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeQuiz()">&times;</span>
        
        <div id="name-input-container" style="text-align: center; padding: 20px;">
            <h2>üìù Masukkan Nama Anda</h2>
            <input type="text" id="student-name" placeholder="Nama Lengkap..." style="width:100%; padding:15px; margin:20px 0; border-radius:10px; border:2px solid #ddd;">
            <button onclick="startQuiz()" style="padding:15px 40px; background:#8b5a2b; color:white; border:none; border-radius:30px; cursor:pointer; font-weight:bold;">Mulai Ujian üöÄ</button>
        </div>

        <div id="quiz-container" class="hidden">
            <div class="progress-bar"><div class="progress" id="progress"></div></div>
            <img id="quiz-img" src="" class="quiz-image" style="display: none;">
            <div id="question" style="font-size:18px; font-weight:bold; margin-bottom:20px; text-align: center; line-height: 1.6;"></div>
            <div id="options"></div>
            <button id="btn-submit" onclick="checkAnswer()" disabled style="width:100%; padding:15px; background:#8b5a2b; color:white; border:none; border-radius:10px; margin-top:10px; cursor:pointer; font-weight: 600;">Periksa Jawaban ‚úÖ</button>
            <button id="btn-next" onclick="nextQuestion()" class="hidden" style="width:100%; padding:15px; background:#4caf50; color:white; border:none; border-radius:10px; margin-top:10px; cursor:pointer; font-weight: 600;">Soal Berikutnya ‚û°Ô∏è</button>
        </div>

        <div id="result-container" class="hidden" style="text-align: center;">
            <h2>üéâ Hasil Ujian</h2>
            <div id="final-score" style="font-size: 50px; font-weight: 900; color: #8b5a2b; margin: 10px 0;">0/10</div>
            <p id="result-message" style="margin-bottom: 20px; color: #555; font-size: 18px;"></p>
            <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                <button onclick="restartQuiz()" style="padding:15px 30px; border-radius:30px; border:none; background:#8b5a2b; color:white; cursor:pointer; font-weight:bold;">Ulangi Ujian üîÑ</button>
                <button onclick="finishQuiz()" style="padding:15px 30px; border-radius:30px; border:none; background:#4caf50; color:white; cursor:pointer; font-weight:bold;">Selesai & Keluar ‚úÖ</button>
            </div>
        </div>
    </div>
</div>

<footer>¬© 2026 ‚Ä¢ Etnomatematika Candi Penataran</footer>

<script>
const quizData = [
    { question: "Pintu masuk Candi Penataran berbentuk persegi panjang (5m √ó 2m). Berapakah kelilingnya?", options: ["10 m", "12 m", "14 m", "16 m"], correct: 2, image: "soal1.png" },
    { question: "Dinding kaki candi berbentuk persegi panjang (8m √ó 3m). Berapakah luaspermukaannya?", options: ["22 m¬≤", "24 m¬≤", "26 m¬≤", "28 m¬≤"], correct: 1, image: "soal2.png" },
    { question: "Relief indah dipahat di batu persegi dengan sisi 4m. Berapakah kelilingnya?", options: ["12 m", "14 m", "16 m", "18 m"], correct: 2, image: "soal3.png" },
    { question: "Ornamen bunga berbentuk persegi dengan panjang sisi 6m. Berapakah luasnya?", options: ["24 m¬≤", "30 m¬≤", "36 m¬≤", "42 m¬≤"], correct: 2, image: "soal4.png" },
    { question: "Bagian samping tangga membentuk trapesium (sisi sejajar 12m & 8m, tinggi 5m). Berapakah luasnya?", options: ["45 m¬≤", "50 m¬≤", "55 m¬≤", "60 m¬≤"], correct: 1, image: "soal5.png" },
    { question: "Sebuah anak tangga memiliki ukuran 2,5m √ó 1m. Berapakah luas anak tangga tersebut?", options: ["2 m¬≤", "2,5 m¬≤", "3 m¬≤", "3,5 m¬≤"], correct: 1, image: "soal6.png" },
    { question: "Atap bangunan kecil berbentuk segitiga (alas 6m, tinggi 4m). Berapakah luasnya?", options: ["10 m¬≤", "12 m¬≤", "14 m¬≤", "16 m¬≤"], correct: 1, image: "soal7.png" },
    { question: "Hiasan puncak candi berbentuk segitiga siku-siku (sisi 3m, 4m, 5m). Kelilingnya?", options: ["10 m", "12 m", "15 m", "20 m"], correct: 1, image: "soal8.png" },
    { question: "Pondasi tangga besar berbentuk trapesium (sisi sejajar 15m & 9m, tinggi 6m). Luasnya?", options: ["66 m¬≤", "70 m¬≤", "72 m¬≤", "76 m¬≤"], correct: 2, image: "soal9.png" },
    { question: "Pintu utama (4,5m √ó 2m) dipasang bingkai kayu. Berapa meter kayu yang dibutuhkan?", options: ["11 m", "12 m", "13 m", "14 m"], correct: 2, image: "soal10.png" }
];

let currentQ = 0, score = 0, selected = null, studentName = '', rankings = [];

function loadRankings() {
    const saved = localStorage.getItem('candiRankings');
    rankings = saved ? JSON.parse(saved) : [];
    displayRankings();
}

function displayRankings() {
    const listHTML = rankings.slice(0, 10).map((r, i) => {
        let grade = r.score >= 9 ? 'A' : r.score >= 7 ? 'B' : r.score >= 5 ? 'C' : 'D';
        return `<div class="ranking-item">
            <div style="display:flex; gap:15px;"><span>${i<3?['ü•á','ü•à','ü•â'][i]:'üèÖ'}</span><span>${r.name}</span></div>
            <div style="display:flex; gap:15px; align-items:center;"><span>${r.score}/10</span><div class="rank-grade-circle g-${grade}">${grade}</div></div>
        </div>`;
    }).join('');
    document.getElementById('home-ranking-list').innerHTML = listHTML || "<p style='text-align:center;'>Belum ada data skor.</p>";
}

function openCPTP() { document.getElementById('cptpModal').classList.add('active'); }
function closeCPTP() { document.getElementById('cptpModal').classList.remove('active'); }
function openQuiz() { document.getElementById('quizModal').classList.add('active'); resetQuiz(); }
function closeQuiz() { document.getElementById('quizModal').classList.remove('active'); }

function startQuiz() {
    studentName = document.getElementById('student-name').value.trim();
    if(!studentName) return alert("Harap masukkan nama Anda!");
    document.getElementById('name-input-container').classList.add('hidden');
    document.getElementById('quiz-container').classList.remove('hidden');
    loadQuestion();
}

function loadQuestion() {
    const q = quizData[currentQ];
    const imgTag = document.getElementById('quiz-img');
    document.getElementById('question').textContent = q.question;
    
    if(q.image) {
        imgTag.src = q.image;
        imgTag.style.display = 'block';
    } else {
        imgTag.style.display = 'none';
    }

    document.getElementById('options').innerHTML = q.options.map((opt, i) => `<div class="option" onclick="selectOption(${i})">${opt}</div>`).join('');
    document.getElementById('btn-submit').disabled = true;
    document.getElementById('btn-submit').classList.remove('hidden');
    document.getElementById('btn-next').classList.add('hidden');
    document.getElementById('progress').style.width = ((currentQ + 1) / quizData.length * 100) + "%";
}

function selectOption(i) {
    selected = i;
    document.querySelectorAll('.option').forEach((el, idx) => el.className = idx === i ? 'option selected' : 'option');
    document.getElementById('btn-submit').disabled = false;
}

function checkAnswer() {
    const correct = quizData[currentQ].correct;
    document.querySelectorAll('.option').forEach((opt, i) => {
        opt.onclick = null;
        if(i === correct) opt.classList.add('correct');
        if(i === selected && i !== correct) opt.classList.add('wrong');
    });
    if(selected === correct) score++;
    document.getElementById('btn-submit').classList.add('hidden');
    document.getElementById('btn-next').classList.remove('hidden');
}

function nextQuestion() {
    currentQ++;
    if(currentQ < quizData.length) { loadQuestion(); selected = null; } 
    else { showResult(); }
}

function showResult() {
    document.getElementById('quiz-container').classList.add('hidden');
    document.getElementById('result-container').classList.remove('hidden');
    document.getElementById('final-score').textContent = `${score}/${quizData.length}`;
    
    let msg = score >= 8 ? "Luar Biasa! üåü" : score >= 6 ? "Bagus! Terus Belajar. üëç" : "Ayo coba lagi! üí™";
    document.getElementById('result-message').textContent = msg;

    rankings.push({ name: studentName, score });
    rankings.sort((a,b) => b.score - a.score);
    localStorage.setItem('candiRankings', JSON.stringify(rankings));
    displayRankings();
}

function finishQuiz() {
    closeQuiz();
    resetQuiz();
    document.querySelector('.ranking-card').scrollIntoView({ behavior: 'smooth' });
}

function restartQuiz() { resetQuiz(); startQuiz(); }

function resetQuiz() {
    currentQ = 0; score = 0; selected = null;
    document.getElementById('name-input-container').classList.remove('hidden');
    document.getElementById('quiz-container').classList.add('hidden');
    document.getElementById('result-container').classList.add('hidden');
}

function toggleMode() { document.body.classList.toggle('malam'); }

const audio = document.getElementById('gamelanAudio');
const audioBtn = document.getElementById('audioToggle');
audioBtn.onclick = () => {
    if(audio.paused) { audio.play(); audioBtn.textContent = 'üîá'; document.getElementById('audioStatus').textContent = 'Hidup'; }
    else { audio.pause(); audioBtn.textContent = 'üéµ'; document.getElementById('audioStatus').textContent = 'Mati'; }
};

window.onload = loadRankings;
</script>
</body>
</html>